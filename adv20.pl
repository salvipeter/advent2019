% -*- mode: prolog -*-

get(X-Y, V) :-
    map(L), nth1(Y, L, R), string_code(X, R, C),
    to_lower(C, C1), char_code(V, C1).

is_open('.').

is_portal(C) :- char_type(C, alpha).

% Preprocessing - find the portal coordinates to generate rules

find_portal(P1, P2, P3, Swap) :-
    get(P1, V1), is_portal(V1),
    get(P2, V2), is_portal(V2),
    write('portal('),
    ( Swap, write(V2), write(V1)
    ; \+ Swap, write(V1), write(V2)
    ),
    write(','), write(P2),
    write(','), write(P3),
    write(').'), nl.

print_portals :- find_portal(X-1, X-2, X-3, false), fail.
print_portals :- find_portal(X-35, X-34, X-33, true), fail.
print_portals :- find_portal(X-91, X-92, X-93, false), fail.
print_portals :- find_portal(X-125, X-124, X-123, true), fail.
print_portals :- find_portal(1-Y, 2-Y, 3-Y, false), fail.
print_portals :- find_portal(35-Y, 34-Y, 33-Y, true), fail.
print_portals :- find_portal(89-Y, 90-Y, 91-Y, false), fail.
print_portals :- find_portal(123-Y, 122-Y, 121-Y, true), fail.

% Main code (almost the same as in Day 18)

step(P, P) :- get(P, V), is_open(V).
step(P, P1) :-
    get(P, V), is_portal(V),
    portal(A, P, _),
    portal(A, Q, P1), Q \= P.

adjacent(X-Y, P) :- X1 is X - 1, step(X1-Y, P).
adjacent(X-Y, P) :- X1 is X + 1, step(X1-Y, P).
adjacent(X-Y, P) :- Y1 is Y - 1, step(X-Y1, P).
adjacent(X-Y, P) :- Y1 is Y + 1, step(X-Y1, P).

shortest_path(From, To, Length) :-
    shortest_path([path(From,0)], To, [path(From,0)], Length).

shortest_path([path(P,K)|F], T, L, N) :-
    findall(A, adjacent(P, A), As),
    ( member(T, As), N is K + 1
    ; neighbor_paths(As, L, K, L1),
      append(F, L1, F1), append(L1, L, L2),
      shortest_path(F1, T, L2, N)
    ).

neighbor_paths([], _, _, []).
neighbor_paths([P|Ps], L, K, L1) :-
    member(path(P,K1), L), K + 1 >= K1,
    !, neighbor_paths(Ps, L, K, L1).
neighbor_paths([P|Ps], L, K, [path(P,K1)|L1]) :-
    K1 is K + 1,
    neighbor_paths(Ps, L, K, L1).

adv20(X) :-
    portal(aa, _, From),
    portal(zz, _, To),
    shortest_path(From, To, X), !.

% Another preprocessing - finding portal connections

% Comment out the second rule of step/2 when doing this
find_connections :-
    portal(A, Qa, Pa),
    portal(B, Qb, Pb), B \= A,
    shortest_path(Pa, Pb, N),
    write('connection('),
    write(A), write(','),
    inout(Qa, Ia), write(Ia), write(','),
    write(B), write(','),
    inout(Qb, Ib), write(Ib), write(','),
    write(N), write(').'),
    nl, fail.

inout(_-2, out).
inout(_-34, in).
inout(_-92, in).
inout(_-124, out).
inout(2-_, out).
inout(34-_, in).
inout(90-_, in).
inout(122-_, out).

% Shortest connection search

other_side(in, out).
other_side(out, in).

adjacent1(pos(A,I,L), pos(B,I1,L1), D) :-
    connection(A, I, B, I0, D),
    other_side(I0, I1),
    ( B = zz, L = 0, L1 = 0
    ; B \= zz, I0 = out, L > 0, L1 is L - 1
    ; I0 = in, L1 is L + 1
    ).

shortest_path1(From, To, Length) :-
    shortest_path1([path(From,0)], To, [path(From,0)], Length).

shortest_path1([path(P,K)|_], P, _, K).
shortest_path1([path(P,K)|F], T, L, N) :-
    findall(A-D, adjacent1(P, A, D), As),
    neighbor_paths1(As, L, K, L1),
    append(F, L1, F1), append(L1, L, L2),
    shortest_path1(F1, T, L2, N).

neighbor_paths1([], _, _, []).
neighbor_paths1([P-D|Ps], L, K, L1) :-
    member(path(P,K1), L), K + D + 1 >= K1,
    !, neighbor_paths1(Ps, L, K, L1).
neighbor_paths1([P-D|Ps], L, K, [path(P,K1)|L1]) :-
    K1 is K + D + 1,
    neighbor_paths1(Ps, L, K, L1).

adv20b(X) :-
    shortest_path1(pos(aa,out,0), pos(zz,in,0), X1),
    X is X1 - 1, !. % because we also go through the ZZ gate

% Example

% Generated connection data

connection(jg,out,fz,in,64).
connection(lv,out,og,in,58).
connection(pm,out,od,in,52).
connection(pi,out,xl,in,62).
connection(vo,out,tr,out,4).
connection(vo,out,nb,in,56).
connection(vo,out,uy,in,58).
connection(tr,out,vo,out,4).
connection(tr,out,nb,in,54).
connection(tr,out,uy,in,56).
connection(xc,out,ww,in,80).
connection(fz,in,jg,out,64).
connection(og,in,lv,out,58).
connection(od,in,pm,out,52).
connection(xl,in,pi,out,62).
connection(nb,in,vo,out,56).
connection(nb,in,tr,out,54).
connection(nb,in,uy,in,4).
connection(uy,in,vo,out,58).
connection(uy,in,tr,out,56).
connection(uy,in,nb,in,4).
connection(ww,in,xc,out,80).
connection(vo,in,og,out,56).
connection(jh,in,ck,out,52).
connection(yp,in,nb,out,60).
connection(tr,in,xl,out,40).
connection(ck,in,fz,out,74).
connection(br,in,sl,out,58).
connection(oa,in,ww,out,52).
connection(og,out,vo,in,56).
connection(ck,out,jh,in,52).
connection(nb,out,yp,in,60).
connection(xl,out,tr,in,40).
connection(fz,out,ck,in,74).
connection(sl,out,br,in,58).
connection(ww,out,oa,in,52).
connection(pl,out,el,in,48).
connection(yp,out,th,in,46).
connection(ev,out,xc,in,68).
connection(wv,out,aa,out,14).
connection(wv,out,pi,in,56).
connection(aa,out,wv,out,14).
connection(aa,out,pi,in,44).
connection(el,out,wv,in,78).
connection(uy,out,xp,in,62).
connection(zz,out,jh,out,8).
connection(zz,out,ev,in,72).
connection(jh,out,zz,out,8).
connection(jh,out,ev,in,78).
connection(el,in,pl,out,48).
connection(th,in,yp,out,46).
connection(xc,in,ev,out,68).
connection(pi,in,wv,out,56).
connection(pi,in,aa,out,44).
connection(wv,in,el,out,78).
connection(xp,in,uy,out,62).
connection(ev,in,zz,out,72).
connection(ev,in,jh,out,78).
connection(pm,in,br,out,64).
connection(lv,in,un,out,62).
connection(un,in,od,out,58).
connection(sl,in,oa,out,44).
connection(pl,in,xp,out,74).
connection(jg,in,th,out,56).
connection(br,out,pm,in,64).
connection(un,out,lv,in,62).
connection(od,out,un,in,58).
connection(oa,out,sl,in,44).
connection(xp,out,pl,in,74).
connection(th,out,jg,in,56).

% Generated portal data

portal(jg,42-2,42-3).
portal(lv,50-2,50-3).
portal(pm,54-2,54-3).
portal(pi,66-2,66-3).
portal(vo,70-2,70-3).
portal(tr,72-2,72-3).
portal(xc,80-2,80-3).
portal(fz,40-34,40-33).
portal(og,50-34,50-33).
portal(od,60-34,60-33).
portal(xl,62-34,62-33).
portal(nb,72-34,72-33).
portal(uy,74-34,74-33).
portal(ww,82-34,82-33).
portal(vo,38-92,38-93).
portal(jh,44-92,44-93).
portal(yp,56-92,56-93).
portal(tr,64-92,64-93).
portal(ck,70-92,70-93).
portal(br,76-92,76-93).
portal(oa,84-92,84-93).
portal(og,40-124,40-123).
portal(ck,46-124,46-123).
portal(nb,54-124,54-123).
portal(xl,62-124,62-123).
portal(fz,66-124,66-123).
portal(sl,76-124,76-123).
portal(ww,82-124,82-123).
portal(pl,2-38,3-38).
portal(yp,2-44,3-44).
portal(ev,2-50,3-50).
portal(wv,2-58,3-58).
portal(aa,2-62,3-62).
portal(el,2-72,3-72).
portal(uy,2-76,3-76).
portal(zz,2-86,3-86).
portal(jh,2-88,3-88).
portal(el,34-40,33-40).
portal(th,34-48,33-48).
portal(xc,34-56,33-56).
portal(pi,34-60,33-60).
portal(wv,34-72,33-72).
portal(xp,34-76,33-76).
portal(ev,34-88,33-88).
portal(pm,90-40,91-40).
portal(lv,90-50,91-50).
portal(un,90-62,91-62).
portal(sl,90-70,91-70).
portal(pl,90-76,91-76).
portal(jg,90-86,91-86).
portal(br,122-42,121-42).
portal(un,122-50,121-50).
portal(od,122-58,121-58).
portal(oa,122-64,121-64).
portal(xp,122-72,121-72).
portal(th,122-84,121-84).

% Data

map(['                                         J       L   P           P   V T       X                                           ',
     '                                         G       V   M           I   O R       C                                           ',
     '  #######################################.#######.###.###########.###.#.#######.#########################################  ',
     '  #...#.........#.#...#.#...#.........#.....#.#.....#.......#...#...#.....#.#...........#...........#.......#...#.......#  ',
     '  ###.#########.#.#.###.#.#######.###.###.###.#####.#.###.###.#####.###.###.#####.#.#######.#####.###.#.#####.#####.#####  ',
     '  #.#.....#...........#...#...#.#.#.....#.....#.#...#.#.....#.#.#.....#.....#.....#.#.#.#.......#.#...#.....#.#.#.....#.#  ',
     '  #.#####.#####.###.#####.###.#.#######.#.#.###.#.#####.###.#.#.#.#########.#.#.#####.#.###.#######.#.#######.#.###.###.#  ',
     '  #...#...#.....#...#.#...#.#.#...#.#.....#.#.......#...#.#.#...#.#.#.......#.#.#...............#.#.#.........#.#.#.....#  ',
     '  ###.#.#.#########.#.###.#.#.#.###.#.#.#########.#####.#.#.#.#.#.#.###.#####.###.#.#.#.###.#.###.###.#######.#.#.#.#####  ',
     '  #.....#...#.....#.........#...#.#...#.........#.....#.#...#.#.....#.....#.#.#...#.#.#.#...#...........#...#.........#.#  ',
     '  #########.#####.#.#.#.#.#.###.#.#######.#####.###.#####.###.###.###.#####.#.#.###.#.#.###.#.#####.#.###.#########.###.#  ',
     '  #.#.........#.....#.#.#.#.#.......#.......#.#.#.......#.#...#.#...#...#...#.....#.#.#...#.#.....#.#.............#.#...#  ',
     '  #.###.###.#####.#########.###.#####.###.#.#.#####.#####.###.#.###.#.###.###.#.###.#######.###.#.#.#.#######.#####.###.#  ',
     '  #...#...#.....#.#.#...#.........#...#...#.#.....#.#.#.....#...#...#.......#.#.#.........#...#.#.#.#.......#.#...#.#.#.#  ',
     '  #.#########.###.#.#.#####.#.###.###.#######.###.#.#.#.###.###.###.#.#.#.###.#####.#.###.#.#.###.#.#.#.#######.#.###.#.#  ',
     '  #...#.......#.#.#.....#.#.#.#...........#.....#.....#.#...#.....#.#.#.#.#.......#.#.#...#.#.#.#.#.#.#...#...#.#.#.#...#  ',
     '  #.#########.#.###.###.#.###########.#########.###########.#.###.###.###.#########.#########.#.#####.#.###.###.###.###.#  ',
     '  #...#.#.#.......#.#.....#.....#.....#.#.......#.#...#.#...#...#.#.#.#.#.#...#...........#.#.....#...#.....#...#.......#  ',
     '  ###.#.#.#####.#####.###.#####.#####.#.#####.###.###.#.###.#.#####.#.#.###.#######.#######.#.#######.#.###.###.#####.###  ',
     '  #.....#.#.#.#.....#.#.#.........#.#.....#.#...........#...#.....#.........#...#...#...#...#.#.#...#.#.#.#...#.#.#.....#  ',
     '  #.#.#.#.#.#.#.#######.#########.#.###.###.###.#####.#####.#.#######.#########.###.###.###.###.#.#####.#.#####.#.#.#.###  ',
     '  #.#.#.......#.....#.#.#.#.#.#.#.#.....#...#...#.#.#.#...#.#.#.#.#.....#...#...#...#...#.....#.....#.#.#.#...#...#.#.#.#  ',
     '  #####.#####.#.#####.#.#.#.#.#.#.###.#####.#.###.#.###.###.#.#.#.#.#.###.###.#.#.#####.#.#.#######.#.###.#.#####.###.#.#  ',
     '  #.#.#.#.....#.....#.......................#...#...#.......#.....#.#.#.......#.#.........#...#.#.#.#...#.....#.#.#.....#  ',
     '  #.#.#######.#.#######.###.#.#####.#######.#.#####.#.#.###.###.#####.#######.#.###.#######.#.#.#.#.#.#####.###.#.###.###  ',
     '  #...#...........#.#.#.#...#.#...#.#...#.#.#.....#...#...#.#...#...........#.#...#.....#.#.#...........#...#...#.#...#.#  ',
     '  ###.#.#.###.#.###.#.#.#.#####.#####.###.#.#.#######.#.#.#.#.###########.###.###.#.#.#.#.#.#.#.#.###.#.###.###.#.#.#.#.#  ',
     '  #.....#.#.#.#.#.....#.#...#...#.#.#.....#.#.....#...#.#.#.#...#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.......#.#...#  ',
     '  ###.#.#.#.#.#####.###########.#.#.#.###.#.#.#####.#.#######.###.#.#.#.#.#.#.#.#.#.#####.#.#######.#######.#.###.#.#####  ',
     '  #.#.#.#.#...#.#.......#.......#.....#.#.#.#...#.#.#.......#.......#.#...#.#.#.#...#.#...#.#...#...#...#...#.#...#.....#  ',
     '  #.#########.#.###.#.#####.#.#.#####.#.#.#.###.#.###.###.#########.#.#######.#.#####.###.###.###.#####.#########.###.###  ',
     '  #.....#.#.#.#.....#...#...#.#.#.......#...#.....#.....#...#.......#.....#.................#...#...#.........#.#.#.#...#  ',
     '  #.#####.#.#.#######.#######.#########.#########.#########.#.#########.#.#######.#########.#.###.#####.#######.#.#.#.###  ',
     '  #.....#.#.#.#...#.#.#.#.#.#...#      F         O         O X         N U       W        #.#.....#.#.#...#.#.#.........#  ',
     '  #.#####.#.#.#.###.#.#.#.#.#.###      Z         G         D L         B Y       W        ###.#####.#.###.#.#.###.###.###  ',
     '  #...#.#.#.#.#.#...#.......#...#                                                         #.......#.....#...#...#.#.#...#  ',
     '  #.###.#.#.#.#.###.#.#.###.#.#.#                                                         #.#.#######.###.#.###.#.#.#.###  ',
     'PL....#.#.#...#...#...#...#...#.#                                                         #.#.#.#.#...#.#.#.....#.#.#.#.#  ',
     '  #.###.#.###.#.###.#.#.#.###.#.#                                                         #.###.#.#.###.###.#######.#.#.#  ',
     '  #.......#.#.......#.#.#.#...#..EL                                                     PM..#.........#.#.....#.#.......#  ',
     '  #.#.#.###.###.#.#.###########.#                                                         #.###.###.###.#.#.#.#.###.###.#  ',
     '  #.#.#.........#.#.#.....#...#.#                                                         #.#.#...#.......#.#.......#....BR',
     '  #############.#.#####.###.#####                                                         #.#.###.#########.#.#.###.###.#  ',
     'YP..#.........#.#...#.#.#.#.....#                                                         #.#...#.....#.#.#.#.#...#...#.#  ',
     '  #.#.###.#.#####.###.#.#.###.#.#                                                         #.#.#.###.###.#.###########.#.#  ',
     '  #...#.#.#.#.#.#.#...#.....#.#.#                                                         #...#.....#.#.#.#...#.#...#.#.#  ',
     '  #.###.###.#.#.###.#.#.#.###.###                                                         ###########.#.#.#.###.###.###.#  ',
     '  #...#.#...........#...#........TH                                                       #.......#...............#...#.#  ',
     '  ###.#.#####################.###                                                         #.#####.#.###.###.#####.#.#.###  ',
     'EV..#.#...#.................#...#                                                       LV..#.#.....#...#...#.#.#...#.#..UN',
     '  #.###.#.#####.#.###.#.#.###.###                                                         #.#.#.###.###.#.#.#.#.#####.#.#  ',
     '  #.#...#...#...#.#...#.#.#.#...#                                                         #.#...#.#.#.#.#.#.#.#.......#.#  ',
     '  #.#.#####.#.#.#.###.###.#.#####                                                         #######.###.#######.#.#######.#  ',
     '  #.#.#.....#.#.#...#.#.#.......#                                                         #.#.......#.....#.#.#.........#  ',
     '  #.#.#.#######.#######.###.#.#.#                                                         #.#####.#.###.###.#.###########  ',
     '  #...#...........#...#...#.#.#..XC                                                       #...#.#.#.........#...........#  ',
     '  #######.#########.###.###.#####                                                         #.#.#.###.###.###.###.#.#.#.###  ',
     'WV..#.#.#.#...............#.#.#.#                                                         #.#...#.#.#.#.#.......#.#.#....OD',
     '  #.#.#.#.#.#.#.###.#####.###.#.#                                                         #.###.#.#.#.#########.#########  ',
     '  #.....#.#.#.#...#.#.....#.#.#..PI                                                       #.#.....#...#.....#.#.....#...#  ',
     '  #####.###.#####.#.#####.#.#.#.#                                                         #.#.#.#.###.###.###.#########.#  ',
     'AA........#.....#.#.#...#.......#                                                       UN..#.#.#.....#...#...#.#.#.#...#  ',
     '  #.#######.###########.###.###.#                                                         ###.###########.###.#.#.#.###.#  ',
     '  #...........#.#.#.#.....#.#.#.#                                                         #...#...#.......#..............OA',
     '  #.#.#.#.#.#.#.#.#.###.#####.###                                                         #####.#.#.#.###.#.#.###.###.#.#  ',
     '  #.#.#.#.#.#.....#.............#                                                         #.#...#...#.#.....#.#...#...#.#  ',
     '  #################.#########.###                                                         #.#.###.#.#########.###########  ',
     '  #.....#.#.#.#.......#.....#...#                                                         #.#...#.#.#.......#.#.#.....#.#  ',
     '  #.#.###.#.#.#######.#.###.###.#                                                         #.#.###.#.#.#########.#.#####.#  ',
     '  #.#.#...#...#.#...#.....#.#.#.#                                                       SL....#.#.#.#.#.#.....#...#.#...#  ',
     '  #.#.#.#.#.###.#.#.#######.#.#.#                                                         #####.#####.#.#.#.#####.#.#.###  ',
     'EL..#...#.........#.........#.#..WV                                                       #...............#.#.#..........XP',
     '  #.###########.###.#########.###                                                         #.#########.###.###.###.#####.#  ',
     '  #.#.......#...#...#...........#                                                         #.#.....#...#...#...#.......#.#  ',
     '  ###.#####.###.#########.#.###.#                                                         #.#.###.#.#.#####.#.#####.#.#.#  ',
     'UY..#...#.....#.#.........#.#....XP                                                     PL..#...#...#.#.#.#.#...#...#.#.#  ',
     '  #.#.###.#.###########.#.#.#####                                                         #.###.#######.#.###.#.#.#####.#  ',
     '  #.#.#...#.#.#.#.#.#...#.#.....#                                                         #...#...............#.....#.#.#  ',
     '  #.#.#.#####.#.#.#.###.###.#####                                                         #.#.###############.#.#.###.#.#  ',
     '  #...#...................#.....#                                                         #.#.#...........#...#.#.#...#.#  ',
     '  ###############.###############                                                         #.#.###.#######.###########.###  ',
     '  #...........#.#.#.............#                                                         #.#.#.....#...........#...#.#.#  ',
     '  #####.#.#.###.###.#######.###.#                                                         #########.#.#.###########.#.#.#  ',
     '  #.....#.#.#.#.#.........#.#...#                                                         #.#.#.....#.#.#...#...#...#....TH',
     '  #.#####.###.#.#######.#####.###                                                         #.#.###.#.#.#########.###.#.#.#  ',
     'ZZ....#...#...#.#...........#.#.#                                                       JG........#.#.................#.#  ',
     '  ###.#.###.#.#.###.#.#.#####.#.#                                                         #.###.#.###.#.#.#####.###.#.###  ',
     'JH....#.....#.......#.#...#......EV                                                       #.#...#...#.#.#...#.....#.#...#  ',
     '  #.#.#######.#.#####.#.#####.###                                                         #.###.#########.###.#.#####.#.#  ',
     '  #.#.#.......#.#.#.#.#.....#.#.#                                                         #.#...#...........#.#.#.#...#.#  ',
     '  #.#.###.#.#.###.#.#.#######.#.#    V     J           Y       T     C     B       O      #.#####.###.#.###.#.###.###.#.#  ',
     '  #.#.#...#.#...#.....#.#.......#    O     H           P       R     K     R       A      #.#.....#...#...#.#.#.#.....#.#  ',
     '  #.#.#.#.###.#.#.#.#.#.#.###.#.#####.#####.###########.#######.#####.#####.#######.###############.#.#.#.###.#.#.#.#.###  ',
     '  #.#.#.#.#...#.#.#.#...#...#.#.#.......#.......#...#.....#.....#.......#...#...#.........#.#.#.....#.#.#.#.#.#...#.#.#.#  ',
     '  ###.#####.#.#######.###.###.#######.#####.#####.###.#######.###.#######.###.#.#.#.#.###.#.#.###.#####.###.#########.#.#  ',
     '  #.....#.#.#.....#...#...#.#.#...........#.........#.....#...#.#.....#.#.....#.#.#.#.#.....#...#.#.#.........#.........#  ',
     '  #.#####.#.###.#####.#####.#.#.###.###.#.###.#.###.#####.#.#.#.#.#####.###.###.#.#####.#.###.#####.###.###.###.#.#.###.#  ',
     '  #...#...#...#.#.........#...#.#...#.#.#.#.#.#...#.#.....#.#...#.......#.#.#...#.#...#.#.#.....#.#.....#.....#.#.#.#...#  ',
     '  #######.#####.#####.#######.#####.#.#.###.#####.#####.###.###########.#.#####.#.#.#########.###.###.#.###.#######.###.#  ',
     '  #.......#.#.....#...#.........#...#.#.#...#.........#...#.#.#.......#...#.#.#.#...#...#...#.#.....#.#.#.#.#.........#.#  ',
     '  #.#.#.#.#.#.#####.#####.###.#####.#.#.#.#####.#.#.#.###.#.#.#####.#.#.###.#.#.#.###.###.###.###.###.###.###.#.###.#####  ',
     '  #.#.#.#.......#...#...#.#...#.......#.#...#...#.#.#.#.#.#.....#...#.#.....#...#...#.#.#.........#.#...#...#.#.#.......#  ',
     '  #######.###.###.#.#.###############.###.#####.###.###.#.#.#.#.#.#.#.#.###.###.###.#.#.#.###.#.###.###.#.#.#.#####.#.#.#  ',
     '  #...#.#.#.....#.#.#.#.........#.#.........#.....#.#...#.#.#.#.#.#.#.....#.#...#...#...#...#.#.....#.#.#.#.......#.#.#.#  ',
     '  #.###.###.#.#####.#.#########.#.#######.#.###.#####.###.#.#.#####.###.#######.#.###.###.#######.#.#.#####.#.#.#.###.###  ',
     '  #.....#...#...#.#.....#...............#.#.#.....#.......#.#.#.....#.#...#.....#.....#.....#.....#.....#.#.#.#.#.#.....#  ',
     '  #####.#.#.###.#.#.#########.#####.###.#.###.###.#######.#.#####.###.#.#.#####.#.###.#.#.#######.#.#.###.#.#######.#.#.#  ',
     '  #.......#.#.#.#.....#.......#.#...#.#.....#.#...#.#.#...#...#.......#.#.#.....#.#.....#...#...#.#.#.#.......#.#.#.#.#.#  ',
     '  #.###.#.#.#.###.#######.#####.#.#.#####.#.###.###.#.#.#.#.#####.#####.#####.###.#.###.###.#.###.#.###########.#.#.#.#.#  ',
     '  #.#.#.#.#...#...#...#.#.#.#.#.#.#.....#.#...#...#.....#.#...#.#.....#.#.......#.#.#...#.#.....#.#.#.........#...#.#.#.#  ',
     '  #.#.#.#.#.###.#####.#.###.#.#.###.#######.#####.#.###.###.#.#.#.#############.#######.#.#.###.#####.#.###.###.#####.###  ',
     '  #.#.#.#.#...#...#.#.....................#.#.....#...#.#...#...#.#...#.#.......#...#.#...#.#.#.#.....#.#.........#.#...#  ',
     '  #.#.#.#.#.#######.#####.#####.#####.#########.#.#.#########.#.#.###.#.#####.###.###.#.#.###.#####.#########.#####.#####  ',
     '  #.#...#.#.#...#.........#.#.#.#.......#...#.#.#.#.........#.#.#.#.....#...........#...#.#.......#.#.#.#.#...........#.#  ',
     '  #.#######.###.###.#######.#.#####.#####.###.#.#######.#####.###.###.#.###.###.#######.#######.###.#.#.#.###.###.###.#.#  ',
     '  #.....#.#.#.#.#.#.#.#.....#.........#.........#.#...#...#.#...#.....#.#.#...#.#.#.#.#.....#...............#...#.#.....#  ',
     '  #.#####.###.#.#.###.#####.#######.#####.#.###.#.#.#.#.###.#.#########.#.#.###.#.#.#.#.#########.#####.#.#.#######.#.#.#  ',
     '  #.#.#.......................#.#.#.#...#.#.#.....#.#...#.#...#.#.#.......#.#.....#.#...#...#.........#.#.#.......#.#.#.#  ',
     '  #.#.#.###.#####.#########.#.#.#.#.#.###########.#.###.#.#.###.#.###.###.###.#####.###.###.#.#.#.#.###.#####.#.###.#####  ',
     '  #.#...#.#.#.#...#.........#.........#...#.#.....#...#.#.......#...#...#.#.....#...#.........#.#.#...#...#...#.#.#...#.#  ',
     '  #######.###.###.#####.#####.#####.#.#.###.###.###.#######.#.#.#.#####.#######.#.#.#.#####.#####.#.#.#.#####.###.#####.#  ',
     '  #...............#.....#.......#...#.....#.......#.....#...#.#.#.......#.......#.#.......#.....#.#.#.#.....#...........#  ',
     '  #####################################.#####.#######.#######.###.#########.#####.#######################################  ',
     '                                       O     C       N       X   F         S     W                                         ',
     '                                       G     K       B       L   Z         L     W                                         ']).
